---
layout:     post
title:      mysql
subtitle:   mysql面试题集合
date:       2022-11-21
author:     xxyy
header-img: img/the-first.png
catalog:    false
tags:
    - mysql
---

### char 与 varchar的区别:
* char定长，varchar不定长，空间上varchar优
* varchar需要在报文头记录实际长度，时间上char优

#### ACID
* (Atomicity) 原子性： 事务是最小的执行单位，不允许分割。原子性确保动作要么全部完成，要么完全不起作用
* (Consistency) 一致性： 执行事务前后，数据保持一致
* (Isolation) 隔离性： 并发访问数据库时，一个事务不被其他事务所干扰
* (Durability) 持久性: 一个事务被提交之后。对数据库中数据的改变是持久的，即使数据库发生故障

### 事务的隔离级别
* 读未提交
* 读已提交
* 可重复度
* 串行化

* 脏读: 一个事务读到了另一个未提交事务修改过的数据
* 幻读: 一个事务先根据某些条件查询出一些记录，之后另一个事务又向表中插入了符合这些条件的记录，原先的事务再次按照该条件查询时，能把另一个事务插入的记录也读出来
* 不可重复读: 一个事务只能读到另一个已经提交的事务修改过的数据，并且其他事务每对该数据进行一次修改并提交后，该事务都能查询得到最新值

|:-------:|:-------:|:---------:|:-------:|
|         | 脏读    |  不可重复度|   幻读   | 
| 读未提交 |    Y   |      Y    |     Y    | 
| 读已提交 |    N   |      Y    |     Y    | 
| 可重复度 |    N   |      N    |     Y    | 
| 串行化读 |    N   |      N    |     N    | 

### 索引

#### 数据结构

#### 索引失效
* 1、在索引字段上运算
```
select * from t4 where id-1 = 1;
```

* 多个索引字段进行运算
```
select * from t4 where id + client_type = 1;
```

* 隐性转换
如果索引列是INT类型，隐性转换可以使用到索引。但是如果索引列是字符型，隐性转换无法使用索引。
```
# 不能使用索引，因为security_code字段是字符，它要变成INT型才能和688688比较，所以索引失效
select * from t4 where security_code = 688688;

# 可以使用索引，因为查询优化器是把'1'变成1，然后索引列没有变化，可以使用索引。
select * from t4 where id = '1';
```

* Like
```
select * from t4 where id like '%1';
```

* OR操作符
1. OR条件的两边都是同一个索引列的情况下，如果WHERE条件是主键，则可以使用索引
2. OR条件的两边都是同一个索引列的情况下，如果WHERE条件不是主键，则是否使用索引取决于MySQL查询优化器的代价估算。
3. OR条件的两边是不同的索引列，是否使用索引取决于MySQL查询优化器的代价估算。如果能使用索引，MySQL会使用索引，如果代价太高，仍然会走全表索引
4. 如果多个OR条件中有其中一个条件没有索引，则必须进行全表索引

* 数据量庞大
当索引查询的数据量较为庞大时，优化器会将索引查询优化为全表扫描，目的是为了减少数量及其庞大的随机IO，以达到优化的目的，所以解决此问题的关键在于，我们建立索引时尽量不要建立在数据比较集中的字段上

#### 联合索引

### 数据库分库/分表策略

### 数据落磁盘的形式
